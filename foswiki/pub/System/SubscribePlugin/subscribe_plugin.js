jQuery(function($){"use strict";$(document).on("click",".subscribe_link",function(){var $this=$(this),params=$this.data(),url=foswiki.getScriptUrlPath("rest","SubscribePlugin","subscribe");if(typeof StrikeOne!=="undefined"){params["validation_key"]=StrikeOne.calculateNewKey(params.validationKey)}$.ajax({type:"POST",data:params,url:url,success:function(response){if($this.text()=="\n"){$this.attr("title",response.message)}else{$this.text(response.message)}params.remove=response.remove},error:function(jqXHR){alert("Error: "+jqXHR.responseText)},complete:function(jqXHR,status){var nonce=jqXHR.getResponseHeader("X-Foswiki-Validation");if(nonce){params.validationKey="?"+nonce}}});$this.blur();return false})});